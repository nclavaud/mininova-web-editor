{"version":3,"sources":["midi.command.ts","midi.ts","mininova.nrpn.js","redux/patch.js","mininova.js","components/InputEnum.js","components/InputRange.js","components/Control.js","components/Oscillator.js","components/Oscillators.js","components/Controls.js","webmidi.ts","redux/midi.js","debug.ts","redux/device.js","components/MIDIDeviceSetup.tsx","adapters/usb.ts","components/USBDeviceSetup.tsx","components/DeviceSetup.js","components/Intro.jsx","App.tsx","serviceWorker.js","redux/usb.js","redux/index.js","index.js"],"names":["CommandType","SYSEX_START","_cc","control","value","cc","Uint8Array","nrpn","msb","lsb","adjustment","concat","isValidSysexValue","isChangePatch","isChangeTempo","getCommand","message","previous","type","ProgramChange","values","length","isNRPNEnd","NRPN","isNRPNMiddle","IncompleteNRPN","isNRPNStart","ControlChange","Array","from","slice","SysEx","Unsupported","sequenceHandshake","sequencePreHandshake","sequencePatchResponse","MIDINOVA_SIGNATURE","mininovaSysex","every","RangeError","sysex","loadPatch","R","decodeCC","waveforms","controls","label","range","init","mapFrom","decode","msg","x","enum","short","inRange","min","max","patchControlChanged","id","payload","initialState","Object","entries","InputEnum","emit","dispatch","useDispatch","useSelector","state","patch","className","htmlFor","onChange","event","Number","target","keys","includes","console","log","map","key","InputRange","readonly","readOnly","Control","props","hasOwnProperty","Oscillator","number","param","Oscillators","i","randomInt","Math","floor","random","Controls","currentPatch","onClick","controlId","startsWith","findDeviceById","devices","filter","device","isSupported","navigator","requestMIDIAccess","detectionComplete","inputs","outputs","debugMidiMessage","prefix","bytes","d","join","noDevice","deviceInputOutputSelected","input","output","MIDIDeviceSetup","onChangeOutput","onIncomingMidiMessage","midi","availableInputs","availableOutputs","useEffect","registerAvailablePorts","access","outputDevicesFound","next","done","push","inputDevicesFound","listPorts","midiDevicesDetected","a","onstatechange","e","detectAvailablePorts","name","onmidimessage","data","deviceInputSelected","selectInput","deviceOutputSelected","selectOutput","href","isLastPartOfSysex","byteLength","USBDeviceIO","incomingMessageBuffer","this","listen","transferIn","result","buffer","appendToIncomingMessageBuffer","dispatchIncomingMessage","b","set","messages","m","ungroup","forEach","transferOut","detectUSB","usb","requestDevice","filters","vendorId","productId","open","selectConfiguration","claimInterface","productName","USBDeviceSetup","onDone","connectToUSBDevice","catch","DOMException","code","SECURITY_ERR","setIncomingMidiMessageListener","DeviceSetup","useState","visible","setVisible","close","Intro","App","undefined","setCurrentPatch","command","None","send","setTimeout","selectPatch","isArray","some","expectedValue","findControl","isPatch","patchDumpReceived","Boolean","window","location","hostname","match","reducer","combineReducers","action","store","createStore","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","then","registration","unregister","error"],"mappings":"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","file":"static/js/main.95f6e9d4.chunk.js","sourcesContent":["import { CC, PROGRAM_CHANGE, SYSEX_START, SYSEX_END } from './midi';\nimport { MidiMessage } from './ports';\nimport { isNRPNStart, isNRPNMiddle, isNRPNEnd } from './mininova.nrpn';\n\nexport enum CommandType {\n  ControlChange,\n  ProgramChange,\n  NRPN,\n  IncompleteNRPN,\n  SysEx,\n  Unsupported,\n  None,\n}\n\nexport interface Command {\n  type: CommandType,\n  values: number[],\n}\n\nexport const getCommand = (message: MidiMessage, previous: Command): Command => {\n  if (message[0] === PROGRAM_CHANGE) {\n    return {\n      type: CommandType.ProgramChange,\n      values: [message[1]],\n    };\n  }\n\n  if (isNRPNEnd(message, previous.values)) {\n    return {\n      type: CommandType.NRPN,\n      values: previous.values.concat(message[2]),\n    };\n  }\n\n  if (isNRPNMiddle(message, previous.values)) {\n    return {\n      type: CommandType.IncompleteNRPN,\n      values: previous.values.concat(message[2]),\n    }\n  }\n\n  if (isNRPNStart(message)) {\n    return {\n      type: CommandType.IncompleteNRPN,\n      values: [message[2]],\n    };\n  }\n\n  if (message[0] === CC) {\n    return {\n      type: CommandType.ControlChange,\n      values: Array.from(message.slice(1)),\n    };\n  }\n\n  if (message[0] === SYSEX_START && message[message.length - 1] === SYSEX_END) {\n    return {\n      type: CommandType.SysEx,\n      values: Array.from(message),\n    };\n  }\n\n  return {\n    type: CommandType.Unsupported,\n    values: Array.from(message),\n  }\n};\n\n","export const CC = 0xB0;\nexport const NRPN_MSB = 0x63;\nexport const NRPN_LSB = 0x62;\nexport const NRPN_VAL = 0x06;\nexport const NRPN_ADJ = 0x26;\nexport const SYSEX_START = 0xF0;\nexport const SYSEX_END = 0xF7;\nexport const PROGRAM_CHANGE = 0xC0;\n\nconst _cc = (control: number, value: number): number[] => [CC, control, value];\n\nexport const cc = (control: number, value: number): Uint8Array => new Uint8Array(_cc(control, value));\n\nexport const nrpn = (msb: number, lsb: number, value: number, adjustment?: number): Uint8Array => new Uint8Array(\n  _cc(NRPN_MSB, msb)\n    .concat(_cc(NRPN_LSB, lsb))\n    .concat(_cc(NRPN_VAL, value))\n    .concat(adjustment ? [CC, NRPN_ADJ, adjustment] : [])\n);\n\nconst isValidSysexValue = (value: number) => value >= 0x00 && value <= 0x7F;\n\nexport const sysex = (values: number[]): Uint8Array => {\n  if (!values.every(isValidSysexValue)) {\n    throw new RangeError(\"Sequence contains invalid sysex value\");\n  }\n\n  return new Uint8Array(\n    [SYSEX_START]\n      .concat(values)\n      .concat([SYSEX_END])\n  );\n};\n\nexport const ungroup = (message: Uint8Array): Uint8Array[] => {\n  const messages = [];\n\n  let m = [];\n  for (let i = 0; i < message.length; i++) {\n    const b = message[i];\n\n    if (m.length > 0 && [0xB0, 0xC0].includes(b)) {\n      messages.push(new Uint8Array(m));\n      m = [];\n    }\n\n    m.push(b);\n  }\n\n  if (m.length > 0) {\n    messages.push(new Uint8Array(m));\n  }\n\n  return messages;\n};\n","import { CC, NRPN_MSB, NRPN_LSB, NRPN_VAL, NRPN_ADJ } from './midi';\n\nexport const isNRPNStart = message => message[0] === CC && message[1] === NRPN_MSB;\n\nexport const isNRPNMiddle = (message, nrpn) => {\n  if (message[0] !== CC) {\n    return false;\n  }\n\n  if (nrpn.length === 1 && message[1] === NRPN_LSB) {\n    return true;\n  }\n\n  if (nrpn.length === 2 && message[1] === NRPN_VAL) {\n    return true;\n  }\n\n  return false;\n}\n\nexport const isNRPNEnd = (message, nrpn) => {\n  if (message[0] !== CC) {\n    return false;\n  }\n\n  if (nrpn.length === 3 && message[1] === NRPN_ADJ) {\n    return true;\n  }\n\n  if (nrpn.length === 2 && message[1] === NRPN_VAL) {\n    return !isChangePatch(nrpn)\n      && !isChangeTempo(nrpn);\n  }\n\n  return false;\n}\n\nconst isChangePatch = nrpn => nrpn[0] === 63 && nrpn[1] === 1;\nconst isChangeTempo = nrpn => nrpn[0] === 2 && nrpn[1] === 63;\n","import { controls } from '../mininova';\n\nconst PATCH_CONTROL_CHANGED = 'PATCH_CONTROL_CHANGED';\nconst PATCH_DUMP_RECEIVED = 'PATCH_DUMP_RECEIVED';\n\nexport const patchControlChanged = (id, value) => (\n  {\n    type: PATCH_CONTROL_CHANGED,\n    payload: {\n      id,\n      value,\n    },\n  }\n);\n\nexport const patchDumpReceived = data => (\n  {\n    type: PATCH_DUMP_RECEIVED,\n    payload: {\n      data,\n    },\n  }\n);\n\nconst initialState = [];\nfor (let [id, control] of Object.entries(controls)) {\n  initialState[id] = control.init;\n}\n\nexport const reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case PATCH_DUMP_RECEIVED:\n      return {\n        ...state,\n        'osc-1-wave': action.payload.data[46],\n        'osc-1-semitones': action.payload.data[53],\n        'osc-1-cents': action.payload.data[54],\n        'osc-1-vsync': action.payload.data[49],\n        'osc-1-pwwti': action.payload.data[48],\n        'osc-1-hardness': action.payload.data[50],\n        'osc-1-density': action.payload.data[51],\n        'osc-1-densitydetune': action.payload.data[52],\n        'osc-1-pitch': action.payload.data[55],\n        'osc-1-wtint': action.payload.data[47],\n        'osc-2-wave': action.payload.data[56],\n        'osc-2-semitones': action.payload.data[63],\n        'osc-2-cents': action.payload.data[64],\n        'osc-2-vsync': action.payload.data[59],\n        'osc-2-pwwti': action.payload.data[58],\n        'osc-2-hardness': action.payload.data[60],\n        'osc-2-density': action.payload.data[61],\n        'osc-2-densitydetune': action.payload.data[62],\n        'osc-2-pitch': action.payload.data[65],\n        'osc-2-wtint': action.payload.data[57],\n        'osc-3-wave': action.payload.data[66],\n        'osc-3-semitones': action.payload.data[73],\n        'osc-3-cents': action.payload.data[74],\n        'osc-3-vsync': action.payload.data[69],\n        'osc-3-pwwti': action.payload.data[68],\n        'osc-3-hardness': action.payload.data[70],\n        'osc-3-density': action.payload.data[71],\n        'osc-3-densitydetune': action.payload.data[72],\n        'osc-3-pitch': action.payload.data[75],\n        'osc-3-wtint': action.payload.data[67],\n      };\n    case PATCH_CONTROL_CHANGED:\n      return {\n        ...state,\n        [action.payload.id]: action.payload.value,\n      };\n    default:\n      return state;\n  }\n};\n","import * as R from 'ramda';\nimport { cc, nrpn, sysex } from './midi';\nimport { CommandType } from './midi.command';\n\n// is it really handshake?\nconst sequenceHandshake = [0x7F, 0x60, 0x21, 0x00, 0x00, 0x00, 0x00];\nconst sequencePreHandshake = [0x7F, 0x62, 0x01, 0x00, 0x00, 0x00, 0x00];\nconst sequenceLoadCurrentPatch = [0x7F, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00];\nconst sequencePatchResponse = [0xF0, 0x00, 0x20, 0x29, 0x03, 0x01, 0x7F, 0x00, 0x00, 0x09, 0x04];\n\nconst MIDINOVA_SIGNATURE = [0x00, 0x20, 0x29, 0x03, 0x01];\nexport const mininovaSysex = values => sysex(MIDINOVA_SIGNATURE.concat(values));\n\nexport const isPatch = message =>\n  R.equals(R.take(sequencePatchResponse.length, Array.from(message)), sequencePatchResponse);\n\nexport const loadPatch = mininovaSysex(sequenceLoadCurrentPatch);\n\nexport const selectPatch = emit => {\n  emit(mininovaSysex(sequencePreHandshake));\n  setTimeout(() => emit(mininovaSysex(sequenceHandshake)), 1000);\n  setTimeout(() => emit(nrpn(63, 0, 1)), 2000);\n  setTimeout(() => emit(loadPatch), 3000);\n};\n\nconst _cc = R.curry(cc);\n\nconst decodeCC = ([, x]) => x;\n\nconst waveforms = [\n  'Sine',\n  'Triangle',\n  'Sawtooth',\n  'Saw9:1PW',\n  'Saw8:2PW',\n  'Saw7:3PW',\n  'Saw6:4PW',\n  'Saw5:5PW',\n  'Saw4:6PW',\n  'Saw3:7PW',\n  'Saw2:8PW',\n  'Saw1:9PW',\n  'PW',\n  'Square',\n  'BassCamp',\n  'Bass_FM',\n  'EP_Dull',\n  'EP_Bell',\n  'Clav',\n  'DoubReed',\n  'Retro',\n  'StrnMch1',\n  'StrnMch2',\n  'Organ_1',\n  'Organ_2',\n  'EvilOrg',\n  'HiStuff',\n  'Bell_FM1',\n  'Bell_FM2',\n  'DigBell1',\n  'DigBell2',\n  'DigBell3',\n  'DigBell4',\n  'DigiPad',\n  'Wtable 1',\n  'Wtable 2',\n  'Wtable 3',\n  'Wtable 4',\n  'Wtable 5',\n  'Wtable 6',\n  'Wtable 7',\n  'Wtable 8',\n  'Wtable 9',\n  'Wtable10',\n  'Wtable11',\n  'Wtable12',\n  'Wtable13',\n  'Wtable14',\n  'Wtable15',\n  'Wtable16',\n  'Wtable17',\n  'Wtable18',\n  'Wtable19',\n  'Wtable20',\n  'Wtable21',\n  'Wtable22',\n  'Wtable23',\n  'Wtable24',\n  'Wtable25',\n  'Wtable26',\n  'Wtable27',\n  'Wtable28',\n  'Wtable29',\n  'Wtable30',\n  'Wtable31',\n  'Wtable32',\n  'Wtable33',\n  'Wtable34',\n  'Wtable35',\n  'Wtable36',\n  'AudInL/M',\n  // Two audio sources are included in the Waveform table;\n  // although the MiniNova only has a single audio input (AudInL/M),\n  // AudioInR is included for compatibility with UltraNova Patches\n  'AudioInR',\n];\n\nexport const controls = {\n  'tempo': {\n    label: 'Tempo',\n    range: [40, 250],\n    init: 40,\n    type: CommandType.NRPN,\n    mapFrom: [\n      [2, 63, 0, [40, 127]],\n      [2, 63, 1, [0, 122]],\n    ],\n    decode: ([, , x, y]) => (x<<7)|y,\n    msg: x => nrpn(2, 63, x>>7, x&127),\n  },\n  'osc-1-wave': {\n    label: 'Wave',\n    enum: waveforms,\n    init: 2,\n    msg: _cc(19),\n  },\n  'osc-1-wtint': {\n    label: 'Wave Table Interpolation',\n    range: [0, 127],\n    init: 127,\n    msg: _cc(20),\n  },\n  'osc-1-pwwti': {\n    label: 'Pulse Width / Wave Table index',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(21),\n  },\n  'osc-1-vsync': {\n    label: 'Virtual Sync',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(22),\n  },\n  'osc-1-hardness': {\n    label: 'Hardness',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(23),\n  },\n  'osc-1-density': {\n    label: 'Density',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(24),\n  },\n  'osc-1-densitydetune': {\n    label: 'Density Detune',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(25),\n  },\n  'osc-1-semitones': {\n    label: 'Semitones',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(26),\n  },\n  'osc-1-cents': {\n    label: 'Detune cents',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(27),\n  },\n  'osc-1-pitch': {\n    range: [52, 76],\n    label: 'Pitch Wheel',\n    init: 76,\n    msg: _cc(28),\n  },\n  'osc-2-wave': {\n    label: 'Wave',\n    enum: waveforms,\n    init: 2,\n    msg: _cc(29),\n  },\n  'osc-2-wtint': {\n    label: 'Wave Table Interpolation',\n    range: [0, 127],\n    init: 127,\n    msg: _cc(30),\n  },\n  'osc-2-pwwti': {\n    label: 'Pulse Width / Wave Table index',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(43),\n  },\n  'osc-2-vsync': {\n    label: 'Virtual Sync',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(33),\n  },\n  'osc-2-hardness': {\n    label: 'Hardness',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(34),\n  },\n  'osc-2-density': {\n    label: 'Density',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(35),\n  },\n  'osc-2-densitydetune': {\n    label: 'Density Detune',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(36),\n  },\n  'osc-2-semitones': {\n    label: 'Semitones',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(37),\n  },\n  'osc-2-cents': {\n    label: 'Detune cents',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(39),\n  },\n  'osc-2-pitch': {\n    label: 'Pitch Wheel',\n    range: [52, 76],\n    init: 76,\n    msg: _cc(40),\n  },\n  'osc-3-wave': {\n    label: 'Wave',\n    enum: waveforms,\n    init: 2,\n    msg: _cc(41),\n  },\n  'osc-3-wtint': {\n    label: 'Wave Table Interpolation',\n    range: [0, 127],\n    init: 127,\n    msg: _cc(42),\n  },\n  'osc-3-pwwti': {\n    label: 'Pulse Width / Wave Table index',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(43),\n  },\n  'osc-3-vsync': {\n    label: 'Virtual Sync',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(44),\n  },\n  'osc-3-hardness': {\n    label: 'Hardness',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(45),\n  },\n  'osc-3-density': {\n    label: 'Density',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(46),\n  },\n  'osc-3-densitydetune': {\n    label: 'Density Detune',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(47),\n  },\n  'osc-3-semitones': {\n    label: 'Semitones',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(48),\n  },\n  'osc-3-cents': {\n    label: 'Detune cents',\n    range: [0, 127],\n    init: 64,\n    msg: _cc(49),\n  },\n  'osc-3-pitch': {\n    label: 'Pitch Wheel',\n    range: [52, 76],\n    init: 76,\n    msg: _cc(50),\n  },\n  'osc-vibrato-depth': {\n    short: 'ModVib',\n    label: 'Vibrato Depth',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(77),\n    type: CommandType.ControlChange,\n    mapFrom: [77, [0, 127]],\n    decode: decodeCC,\n  },\n  'osc-vibrato-speed': {\n    short: 'MVibRate',\n    label: 'Vibrato Rate',\n    range: [0, 127],\n    init: 65,\n    msg: _cc(76),\n    type: CommandType.ControlChange,\n    mapFrom: [76, [0, 127]],\n    decode: decodeCC,\n  },\n  'osc-drift': {\n    short: 'OscDrift',\n    label: 'Oscillator Drift',\n    range: [0, 127],\n    init: 0,\n    msg: _cc(16),\n    type: CommandType.ControlChange,\n    mapFrom: [16, [0, 127]],\n    decode: decodeCC,\n  },\n  'osc-phase': {\n    short: 'OscPhase',\n    label: 'Oscillator Phase',\n    range: [0, 350],\n    init: 0,\n    msg: _cc(17),\n    type: CommandType.ControlChange,\n    mapFrom: [17, [0, 120]],\n    decode: decodeCC,\n  },\n};\n\nconst inRange = (x, [min, max]) => x >= min && x <= max;\n\nexport const findControl = (command) => {\n  for (let [controlId, control] of Object.entries(controls)) {\n    if (!control.mapFrom) {\n      continue;\n    }\n    if (undefined === control.type || control.type !== command.type) {\n      continue;\n    }\n    const maps = Array.isArray(control.mapFrom[0]) ? control.mapFrom : [control.mapFrom];\n    if (maps.some(map => map.every((expectedValue, i) => {\n      if (Array.isArray(expectedValue)) {\n        return inRange(command.values[i], expectedValue);\n      } else {\n        return command.values[i] === expectedValue;\n      }\n    }))) {\n      return {\n        id: controlId,\n        value: control.decode(command.values),\n      }\n    }\n  }\n  return undefined;\n};\n","import React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { patchControlChanged } from '../redux/patch';\n\nfunction InputEnum({ id, control, emit }) {\n  const dispatch = useDispatch();\n  const value = useSelector(state => state.patch[id]);\n\n  const onChange = event => {\n    const value = Number(event.target.value);\n\n    if (!Array.from(control.enum.keys()).includes(value)) {\n      console.log('Wrong value: ' + value);\n      return;\n    }\n\n    dispatch(patchControlChanged(id, value));\n    emit(control.msg(value));\n  };\n\n  return (\n    <div className=\"control\">\n      <label htmlFor={control.id} className=\"control-label\">{control.label}</label>\n      <select onChange={onChange} value={value} className=\"control-input\">\n        {control.enum.map((label, value) => (\n          <option key={value} value={value}>{label}</option>\n        ))}\n      </select>\n    </div>\n  );\n}\n\nexport default InputEnum;\n","import React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { patchControlChanged } from '../redux/patch';\n\nconst inRange = (value, range) => (value >= range[0] && value <= range[1]);\n\nfunction InputRange({ id, control, emit, readonly }) {\n  const dispatch = useDispatch();\n  const value = useSelector(state => state.patch[id]);\n\n  const onChange = event => {\n    const value = Number(event.target.value);\n\n    if (!inRange(value, control.range)) {\n      return;\n    }\n\n    dispatch(patchControlChanged(id, value));\n    emit(control.msg(value));\n  };\n\n  return (\n    <div className=\"control\">\n      <label htmlFor={id} className=\"control-label\">{control.label}</label>\n      <input\n        id={id}\n        className=\"control-input\"\n        type=\"number\"\n        min={control.range[0]}\n        max={control.range[1]}\n        onChange={onChange}\n        value={value}\n        readOnly={readonly}\n      />\n    </div>\n  );\n}\n\nexport default InputRange;\n","import React from 'react';\nimport InputEnum from './InputEnum';\nimport InputRange from './InputRange';\n\nfunction Control(props) {\n  const { control } = props;\n\n  if (control.hasOwnProperty('enum')) {\n    return <InputEnum {...props} />;\n  }\n\n  return <InputRange {...props} />;\n}\n\nexport default Control;\n","import React from 'react';\nimport Control from './Control';\nimport { controls } from '../mininova';\n\nfunction Oscillator({ emit, number }) {\n  const params = [\n    'wave',\n    'semitones',\n    'cents',\n    'vsync',\n    'pwwti',\n    'hardness',\n    'density',\n    'densitydetune',\n    'pitch',\n    'wtint',\n  ];\n\n  return (\n    <div className=\"oscillator\">\n      <h4>Oscillator {number}</h4>\n      {params.map(param => (\n        <Control\n          key={param}\n          id={`osc-${number}-${param}`}\n          control={controls[`osc-${number}-${param}`]}\n          emit={emit}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default Oscillator;\n","import React from 'react';\nimport Oscillator from './Oscillator';\nimport Control from './Control';\nimport { controls } from '../mininova';\n\nfunction Oscillators({ emit }) {\n  return (\n    <div>\n      <div className=\"oscillators\">\n        {[1, 2, 3].map(i => (\n          <Oscillator\n            key={i}\n            emit={emit}\n            number={i}\n          />\n        ))}\n      </div>\n      <div>\n        <h4>Common Oscillator parameters</h4>\n        {['osc-vibrato-depth', 'osc-vibrato-speed', 'osc-drift', 'osc-phase'].map(id => (\n          <Control\n            key={id}\n            id={id}\n            control={controls[id]}\n            emit={emit}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default Oscillators;\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { cc, nrpn } from '../midi';\nimport { controls, loadPatch } from '../mininova';\nimport Oscillators from './Oscillators';\nimport Control from './Control';\nimport { patchControlChanged } from '../redux/patch';\n\nconst randomInt = (min, max) => Math.floor(Math.random() * (max + 1 - min)) + min;\n\nfunction Controls({ currentPatch, emit }) {\n  const dispatch = useDispatch();\n\n  const changeOctave = () => emit(cc(13, 0));\n  const activateArp = () => emit(nrpn(0, 122, 47));\n  const deactivateArp = () => emit(nrpn(0, 122, 46));\n  const selectPrevPatch = () => emit(nrpn(63, 0, 0));\n  const selectNextPatch = () => emit(nrpn(63, 0, 2));\n  const randomize = () => {\n    for (let [controlId, control] of Object.entries(controls)) {\n      if (!controlId.startsWith('osc-')) {\n        continue;\n      }\n      const value = control.range ? randomInt(...control.range) : randomInt(0, control.enum.length);\n      emit(control.msg(value));\n      dispatch(patchControlChanged(controlId, value));\n    }\n  };\n\n  return (\n    <div className=\"controls\">\n      <h3>Patch</h3>\n      <p>Current patch: {currentPatch}</p>\n      <button onClick={selectPrevPatch}>Prev patch</button>\n      <button onClick={selectNextPatch}>Next patch</button>\n      <button onClick={() => emit(loadPatch)}>Load patch</button>\n      <h3>Oct / Arp</h3>\n      <Control\n        id=\"tempo\"\n        control={controls['tempo']}\n        emit={emit}\n        readonly\n      />\n      <button onClick={changeOctave}>Change octave</button>\n      <button onClick={activateArp}>Arp ON</button>\n      <button onClick={deactivateArp}>Arp OFF</button>\n      <h3>Oscillators</h3>\n      <button onClick={randomize}>Randomize</button>\n      <Oscillators emit={emit} />\n    </div>\n  );\n}\n\nexport default Controls;\n","export const requestAccess = () => navigator.requestMIDIAccess({ sysex: true });\n\nexport const listPorts = (access: WebMidi.MIDIAccess) => {\n  const outputDevicesFound = [];\n  const outputs = access.outputs.values();\n  for (let output = outputs.next(); output && !output.done; output = outputs.next()) {\n    outputDevicesFound.push(output.value);\n  }\n\n  const inputDevicesFound = [];\n  const inputs = access.inputs.values();\n  for (let input = inputs.next(); input && !input.done; input = inputs.next()) {\n    inputDevicesFound.push(input.value);\n  }\n\n  return [inputDevicesFound, outputDevicesFound];\n};\n\nexport function findDeviceById<T extends WebMidi.MIDIPort>(id: string, devices: Array<T>): T | null {\n  return devices.filter(device => device.id === id)[0] || null;\n};\n","const MIDI_DEVICES_DETECTED = 'MIDI_DEVICES_DETECTED';\n\nexport const midiDevicesDetected = (inputs, outputs) => (\n  {\n    type: MIDI_DEVICES_DETECTED,\n    payload: {\n      inputs,\n        outputs,\n    },\n  }\n);\n\nconst initialState = {\n  isSupported: !!navigator.requestMIDIAccess,\n  detectionComplete: false,\n  inputs: [],\n  outputs: [],\n};\n\nexport const reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case MIDI_DEVICES_DETECTED:\n      return {\n        ...state,\n        detectionComplete: true,\n        inputs: action.payload.inputs,\n        outputs: action.payload.outputs,\n      };\n    default:\n      return state;\n  }\n};\n","import { DeviceIO, MidiMessage } from './ports';\n\nexport const debugMidiMessage = (message: MidiMessage, prefix: string) => {\n  const bytes = message.map(d => d).join(' ');\n  console.log(`${prefix}${bytes}`);\n};\n\nexport const noDevice = new class implements DeviceIO {\n  send(message: MidiMessage) {}\n  setIncomingMidiMessageListener() {}\n}();\n","import { noDevice } from '../debug';\n\nconst DEVICE_INPUT_SELECTED = 'DEVICE_INPUT_SELECTED';\nconst DEVICE_OUTPUT_SELECTED = 'DEVICE_OUTPUT_SELECTED';\nconst DEVICE_INPUT_OUTPUT_SELECTED = 'DEVICE_INPUT_OUTPUT_SELECTED';\n\nexport const deviceInputSelected = device => (\n  {\n    type: DEVICE_INPUT_SELECTED,\n    payload: {\n      device,\n    },\n  }\n)\n\nexport const deviceOutputSelected = device => (\n  {\n    type: DEVICE_OUTPUT_SELECTED,\n    payload: {\n      device,\n    },\n  }\n)\n\nexport const deviceInputOutputSelected = device => (\n  {\n    type: DEVICE_INPUT_OUTPUT_SELECTED,\n    payload: {\n      device,\n    },\n  }\n)\n\nconst initialState = {\n  input: noDevice,\n  output: noDevice,\n};\n\nexport const reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case DEVICE_INPUT_SELECTED:\n      return {\n        ...state,\n        input: action.payload.device,\n      };\n    case DEVICE_OUTPUT_SELECTED:\n      return {\n        ...state,\n        output: action.payload.device,\n      };\n    case DEVICE_INPUT_OUTPUT_SELECTED:\n      return {\n        ...state,\n        input: action.payload.device,\n        output: action.payload.device,\n      };\n    default:\n      return state;\n  }\n};\n","import React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { MidiMessage } from '../ports';\nimport { findDeviceById, listPorts, requestAccess } from '../webmidi';\nimport { midiDevicesDetected } from '../redux/midi';\nimport { deviceInputSelected, deviceOutputSelected } from '../redux/device';\n\ntype MIDIDeviceSetupProps = {\n  onChangeOutput: () => {},\n  onIncomingMidiMessage: (message: MidiMessage) => void,\n  input: WebMidi.MIDIInput,\n  output: WebMidi.MIDIOutput,\n};\n\ninterface RootState {\n  midi: {\n    isSupported: boolean,\n    detectionComplete: boolean,\n    inputs: WebMidi.MIDIInput[],\n    outputs: WebMidi.MIDIOutput[],\n  },\n};\n\nfunction MIDIDeviceSetup({\n  onChangeOutput,\n  onIncomingMidiMessage,\n  input,\n  output,\n}: MIDIDeviceSetupProps) {\n  const dispatch = useDispatch();\n  const isSupported = useSelector((state: RootState) => state.midi.isSupported);\n  const detectionComplete = useSelector((state: RootState) => state.midi.detectionComplete);\n  const availableInputs = useSelector((state: RootState) => state.midi.inputs);\n  const availableOutputs = useSelector((state: RootState) => state.midi.outputs);\n\n  const selectOutput = (id: string) => {\n    const device = findDeviceById<WebMidi.MIDIOutput>(id, availableOutputs);\n    dispatch(deviceOutputSelected(device));\n    onChangeOutput();\n  };\n\n  const selectInput = (id: string) => {\n    if (input) {\n      input.onmidimessage = (e: WebMidi.MIDIMessageEvent) => {};\n    }\n    const device = findDeviceById<WebMidi.MIDIInput>(id, availableInputs);\n    if (device !== null) {\n      device.onmidimessage = (e: WebMidi.MIDIMessageEvent) => {\n        onIncomingMidiMessage(e.data);\n      }\n    }\n    dispatch(deviceInputSelected(device));\n  };\n\n  useEffect(() => {\n    if (!isSupported) {\n      return;\n    }\n\n    const registerAvailablePorts = (access: WebMidi.MIDIAccess) => {\n      const [inputs, outputs] = listPorts(access);\n      dispatch(midiDevicesDetected(inputs, outputs));\n    };\n\n    const detectAvailablePorts = async () => {\n      const access = await requestAccess();\n      access.onstatechange = e => {\n        registerAvailablePorts(access);\n      }\n      registerAvailablePorts(access);\n    };\n\n    detectAvailablePorts();\n  }, [isSupported, dispatch]);\n\n  if (!isSupported) {\n    return (\n      <div>\n        <p>It looks like your browser does not support MIDI.</p>\n        <p>MIDI access is an experimental technology. Check the list of compatible browsers in the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MIDIAccess#Browser_compatibility\">Browser compatibility table </a>.</p>\n      </div>\n    );\n  }\n\n  if (!detectionComplete) {\n    return <div>Detecting MIDI devices...</div>;\n  }\n\n  return (\n    <div>\n      <p>Available devices:</p>\n      <ul>\n        {availableInputs.map(device => (\n          <li key={device.id}>\n            IN {device.name}\n            {input && device.id === input.id\n              ? ' (selected)'\n              : <button onClick={() => selectInput(device.id)}>select</button>\n            }\n          </li>\n        ))}\n        {availableOutputs.map(device => (\n          <li key={device.id}>\n            OUT {device.name}\n            {output && device.id === output.id\n              ? ' (selected)'\n              : <button onClick={() => selectOutput(device.id)}>select</button>\n            }\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default MIDIDeviceSetup;\n","import { DeviceIO, MidiMessage, MidiMessageFunc } from '../ports';\nimport { ungroup } from '../midi';\n\nconst MININOVA_VENDOR_ID = 0x1235;\nconst MININOVA_PRODUCT_ID = 0x001e;\nconst MININOVA_CONFIGURATION = 1;\nconst MININOVA_INTERFACE = 0;\nconst MININOVA_ENDPOINT_IN = 1;\nconst MININOVA_ENDPOINT_OUT = 2;\nconst MININOVA_BUFFER_LENGTH = 64;\n\nconst isLastPartOfSysex = (message: Uint8Array) => {\n  const lastByte = message[message.byteLength - 1];\n\n  return lastByte === 0xF7;\n};\n\nclass USBDeviceIO implements DeviceIO\n{\n  private device: USBDevice;\n  private onIncomingMidiMessage: MidiMessageFunc;\n  private incomingMessageBuffer: Uint8Array;\n\n  constructor(device: USBDevice) {\n    this.device = device;\n    this.onIncomingMidiMessage = (message: MidiMessage) => {};\n    this.incomingMessageBuffer = new Uint8Array(0);\n  }\n\n  public setIncomingMidiMessageListener(onIncomingMidiMessage: MidiMessageFunc): void {\n    this.onIncomingMidiMessage = onIncomingMidiMessage;\n\n    this.listen();\n  }\n\n  private async listen(): Promise<void> {\n    const result = await this.device.transferIn(MININOVA_ENDPOINT_IN, MININOVA_BUFFER_LENGTH);\n    if (result?.data?.buffer) {\n      const message = new Uint8Array(result.data.buffer);\n      if (message.length === MININOVA_BUFFER_LENGTH && !isLastPartOfSysex(message)) {\n        // incomplete message => store in buffer\n        this.appendToIncomingMessageBuffer(message);\n      } else if (this.incomingMessageBuffer.byteLength > 0) {\n        // end part of a message that has been stored in the buffer\n        this.appendToIncomingMessageBuffer(message);\n        this.dispatchIncomingMessage(this.incomingMessageBuffer);\n        this.incomingMessageBuffer = new Uint8Array(0);\n      } else {\n        // complete message, no buffer involved\n        this.dispatchIncomingMessage(message);\n      }\n    }\n\n    this.listen();\n  };\n\n  private appendToIncomingMessageBuffer(message: Uint8Array): void {\n    const b = new Uint8Array(this.incomingMessageBuffer.byteLength + message.byteLength);\n    b.set(this.incomingMessageBuffer, 0);\n    b.set(message, this.incomingMessageBuffer.byteLength);\n    this.incomingMessageBuffer = b;\n  }\n\n  private dispatchIncomingMessage(message: MidiMessage): void {\n    const messages = ungroup(message);\n    messages.forEach(this.onIncomingMidiMessage);\n  }\n\n  public send(message: Uint8Array): void {\n    this.device.transferOut(MININOVA_ENDPOINT_OUT, message);\n  }\n}\n\nexport const detectUSB = async () => {\n  const device = await navigator.usb.requestDevice({\n    filters: [\n      {\n        vendorId: MININOVA_VENDOR_ID,\n        productId: MININOVA_PRODUCT_ID,\n      }\n    ],\n  });\n  await device.open();\n  await device.selectConfiguration(MININOVA_CONFIGURATION);\n  await device.claimInterface(MININOVA_INTERFACE);\n  console.log(`Connected to ${device.productName}`);\n\n  return new USBDeviceIO(device);\n};\n","import React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { detectUSB } from '../adapters/usb';\nimport { DeviceInput, DeviceOutput, MidiMessage } from '../ports';\nimport { deviceInputOutputSelected } from '../redux/device';\n\ntype USBDeviceSetupProps = {\n  onDone: () => void,\n  onIncomingMidiMessage: (message: MidiMessage) => void,\n  input: DeviceInput,\n  output: DeviceOutput,\n};\n\nfunction USBDeviceSetup({\n  input,\n  onDone,\n  onIncomingMidiMessage,\n}: USBDeviceSetupProps) {\n  interface RootState {\n    usb: {\n      isSupported: boolean,\n    },\n  };\n\n  const dispatch = useDispatch();\n  const isSupported = useSelector((state: RootState) => state.usb.isSupported);\n\n  if (!isSupported) {\n    return (\n      <div>\n        <p>It looks like your browser does not support USB.</p>\n        <p>Web USB is an experimental technology. Check the list of compatible browsers in the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/USB#Browser_compatibility\">Browser compatibility table </a>.</p>\n      </div>\n    )\n  }\n\n  const connectToUSBDevice = async () => {\n    const device = await detectUSB().catch(e => {\n      if (e instanceof DOMException && e.code === DOMException.SECURITY_ERR) {\n        console.log(e);\n        console.log(\"Is the device registered in the list of udev rules?\");\n      } else {\n        throw e;\n      }\n    });\n\n    if (!device) {\n      return;\n    }\n\n    device.setIncomingMidiMessageListener(onIncomingMidiMessage);\n    dispatch(deviceInputOutputSelected(device));\n    onDone();\n  };\n\n  return (\n    <button onClick={connectToUSBDevice}>Connect to USB device</button>\n  );\n}\n\nexport default USBDeviceSetup;\n","import React, { useState } from 'react';\nimport MIDIDeviceSetup from './MIDIDeviceSetup';\nimport USBDeviceSetup from './USBDeviceSetup';\n\nfunction DeviceSetup(props) {\n  const [visible, setVisible] = useState(false);\n\n  if (!visible) {\n    return (\n      <button onClick={() => setVisible(true)}>Choose device</button>\n    );\n  }\n\n  const close = () => setVisible(false);\n\n  return (\n    <div className=\"deviceSetup\">\n      <USBDeviceSetup\n        {...props}\n        onDone={close}\n      />\n      <MIDIDeviceSetup {...props} />\n      <button onClick={close}>Close</button>\n    </div>\n  );\n}\n\nexport default DeviceSetup;\n","import React from 'react';\n\nfunction Intro() {\n    return (\n        <header>\n            <h1>Mininova web editor</h1>\n            <p>Control your Novation Mininova synth from your web browser</p>\n        </header>\n    );\n}\n\nexport default Intro;\n","import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Controls, DeviceSetup, Intro } from './components';\nimport { Command, CommandType, getCommand } from './midi.command';\nimport { findControl, isPatch, loadPatch, selectPatch } from './mininova';\nimport { debugMidiMessage } from './debug';\nimport { DeviceInput, DeviceOutput, MidiMessage } from './ports';\nimport { patchControlChanged, patchDumpReceived } from './redux/patch';\n\ninterface RootState {\n  device: {\n    input: DeviceInput,\n    output: DeviceOutput,\n  }\n}\n\nfunction App() {\n  const input = useSelector((state: RootState) => state.device.input);\n  const output = useSelector((state: RootState) => state.device.output);\n  const [currentPatch, setCurrentPatch] = useState<number | undefined>(undefined);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    emit(loadPatch);\n  }, [currentPatch]);\n\n  const decodePatch = (data: Uint8Array) => {\n    console.log('Received patch.');\n    dispatch(patchDumpReceived(data));\n  }\n\n  let command: Command = {\n    type: CommandType.None,\n    values: [],\n  };\n\n  const onIncomingMidiMessage = (message: MidiMessage) => {\n    debugMidiMessage(message, 'Input: ');\n    command = getCommand(message, command);\n    switch (command.type) {\n      case CommandType.ProgramChange:\n        setCurrentPatch(command.values[0]);\n        break;\n      case CommandType.NRPN:\n        console.log('NRPN: ' + command.values);\n        // omit break\n      case CommandType.ControlChange:\n        const control = findControl(command);\n        if (control) {\n          dispatch(patchControlChanged(control.id, control.value));\n        }\n        break;\n      case CommandType.SysEx:\n        if (isPatch(message)) {\n          decodePatch(message);\n        }\n        break;\n    }\n  };\n\n  const emit = (message: Uint8Array) => {\n    if (!output) {\n      return;\n    }\n    debugMidiMessage(message, 'Output: ');\n    output.send(message);\n  };\n\n  const onChangeOutput = () => selectPatch(emit);\n\n  return (\n    <div>\n      <Intro />\n      <h3>Setup</h3>\n      <DeviceSetup\n        onChangeOutput={onChangeOutput}\n        onIncomingMidiMessage={onIncomingMidiMessage}\n        input={input}\n        output={output}\n      />\n      <Controls\n        currentPatch={currentPatch}\n        emit={emit}\n      />\n      <p><a href=\"https://github.com/nclavaud/mininova-web-editor/\">Contribute on GitHub</a></p>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","const initialState = {\n  isSupported: !!navigator.usb,\n};\n\nexport const reducer = (state = initialState, action) => {\n  switch (action.type) {\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\nimport { reducer as deviceReducer } from './device';\nimport { reducer as midiReducer } from './midi';\nimport { reducer as patchReducer } from './patch';\nimport { reducer as usbReducer } from './usb';\n\nexport const reducer = combineReducers({\n  device: deviceReducer,\n  midi: midiReducer,\n  patch: patchReducer,\n  usb: usbReducer,\n});\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { createStore } from 'redux';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { reducer } from './redux';\n\nconst store = createStore(\n  reducer,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n);\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}